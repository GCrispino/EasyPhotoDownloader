{"version":3,"sources":["UserPage.js","DownloadStatus.js","Album.js","Photo.js","DriveButton.js","LoginPage.js","App.js","registerServiceWorker.js","index.js"],"names":["React","require","DownloadStatus","jszip","Loader","Button","Modal","Album","UserPage","props","getZipFile","downloadedAlbumsInfo","zip","forEach","albumInfo","folder","name","photos","photoData","file","blob","state","downloadInfo","generateAsync","type","then","content","setState","downloading","downloadedContentBlob","photosToDownload","Promise","resolve","downloadImagesAndGetZipFile","downloadImages","catch","console","error","closeModal","openModal","initialUserAlbums","loaded","downloadingAlbumIndex","downloadingPhotoIndex","handleAlbumChange","bind","handlePhotoChange","downloadImagesAndSaveZipFile","assignNewCheckedPhotosToArray","this","createInitialState","userAlbums","newCheckedPhotos","map","photo","i","Object","assign","checked","userId","accessToken","fetchURL","window","location","hostname","reject","fetch","response","json","albums","album","index","e","albumIndex","newUserAlbums","newDownloadInfo","photoDivElem","target","parentNode","parseInt","id","match","slice","photoIndex","curState","isPhotoChecked","newPhotos","userAlbum","newUserAlbum","albumChecked","indexOf","images","source","filter","checkedAlbum","newCheckedAlbum","checkedPhoto","photoObject","downloaded","j","checkedPhotos","filterCheckedPhotos","promises","length","push","all","fetchPhoto","newPhotosToDownload","markPhotoAsDownloaded","albumPhotosData","aElement","document","createElement","objectURL","URL","createObjectURL","style","display","href","download","body","appendChild","click","err","reduce","a","b","concat","key","onAlbumChange","onPhotoChange","Fragment","fluid","onClick","className","textAlign","size","open","onClose","Header","Actions","negative","icon","labelPosition","Component","module","exports","nAllPhotos","downloadedPhotos","getDownloadedPhotos","Photo","Accordion","Icon","collapsed","active","toggleCollapse","toggleActive","handleChange","Title","onChange","Content","displayImage","close","preventDefault","smallestImage","handleClick","src","alt","width","height","DriveButton","createFile","fileData","log","boundary","delimiter","gapi","reader","FileReader","readAsBinaryString","onload","contentType","metadata","title","base64Data","btoa","result","multipartRequestBody","JSON","stringify","client","request","execute","handleClientLoad","load","initClient","self","init","apiKey","API_KEY","clientId","CLIENT_ID","discoveryDocs","DISCOVERY_DOCS","scope","SCOPES","auth2","getAuthInstance","isSignedIn","listen","handleSigninStatusChange","signedIn","get","uploading","contentToUpload","onFinishUpload","authInstance","signIn","signinIn","undefined","script","displayWhenDownloading","hidden","disabled","loading","LoginPage","rotate","color","handleLogin","App","protocol","appId","loggedIn","sdkLoaded","statusChangeCallback","d","s","js","fjs","getElementsByTagName","getElementById","insertBefore","addEventListener","FB","authResponse","userID","login","isLocalhost","Boolean","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","render","process","origin","status","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.351d1c88.chunk.js","sourcesContent":["const React = require('react');\nconst DownloadStatus = require('./DownloadStatus');\nconst jszip = require('jszip');\nconst Loader = require('react-loader');\nconst { Button, Modal } = require('semantic-ui-react');\nconst Album = require('./Album');\nconst DriveButton = require('./DriveButton');\n\n\nclass UserPage extends React.Component{\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.initialUserAlbums = null;\n\n\t\tthis.state = ({\n\t\t\tloaded: false,\n\t\t\topenModal: false,\n\t\t\tdownloadInfo: {\n\t\t\t\tdownloading: false,\n\t\t\t\tdownloadedContentBlob: null,\n\t\t\t\tphotosToDownload: null,\n\t\t\t\tdownloadingAlbumIndex: null,\n\t\t\t\tdownloadingPhotoIndex: null\n\t\t\t}\n\t\t});\n\n\t\tthis.handleAlbumChange = this.handleAlbumChange.bind(this);\n\t\tthis.handlePhotoChange = this.handlePhotoChange.bind(this);\n\t\tthis.getZipFile = this.getZipFile.bind(this);\n\t\tthis.downloadImages = this.downloadImages.bind(this);\n\t\tthis.downloadImagesAndGetZipFile = this.downloadImagesAndGetZipFile.bind(this);\n\t\tthis.downloadImagesAndSaveZipFile = this.downloadImagesAndSaveZipFile.bind(this);\n\t\tthis.assignNewCheckedPhotosToArray = this.assignNewCheckedPhotosToArray.bind(this);\n\t}\n\n\tcomponentDidMount(){\n\t\tthis.createInitialState()\n\t\t.then( userAlbums => {\n\t\t\t\tthis.initialUserAlbums = userAlbums;\n\t\t\t\tthis.setState({\n\t\t\t\t\tuserAlbums,\n\t\t\t\t\tloaded: true\n\t\t\t\t});\n\t\t})\n\t\t.catch(console.error);\n\t}\n\n\tassignNewCheckedPhotosToArray(photos,newCheckedPhotos){\n\t\treturn photos.map( (photo,i) => Object.assign(photo,{\n\t\t\tchecked: newCheckedPhotos[i]\n\t\t}) );\n\t}\n\n\tcreateInitialState(){\n\t\tconst \n\t\t\t{userId,accessToken} = this.props,\n\t\t\tfetchURL = \n\t\t\t\twindow.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'\n\t\t\t\t? `http://localhost/getAlbums?userID=${userId}&access_token=${accessToken}`\n\t\t\t\t: `https://easy-photo-downloader.herokuapp.com/getAlbums?userID=${userId}&access_token=${accessToken}`;\n\n\t\treturn new Promise((resolve,reject) => {\n\t\t\tfetch(fetchURL)\n\t\t\t.then(response => response.json())\n\t\t\t.then(albums => \n\t\t\t\tresolve(\n\t\t\t\t\talbums.map(\n\t\t\t\t\t\t(album,i) => {\n\t\t\t\t\t\t\tconst photos = album.photos.map(photo => Object.assign(photo,{\n\t\t\t\t\t\t\t\tchecked: false\n\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tname: album.name,\n\t\t\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\t\t\tchecked: false,\n\t\t\t\t\t\t\t\t\tphotos\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t\t.catch(reject);\t\n\t\t});\n\t}\n\n\thandleAlbumChange(e,albumIndex){\n\t\tconst {userAlbums,downloadInfo} = this.state;\n\t\tconst { photos } = userAlbums[albumIndex];\n\t\tconst newUserAlbums = userAlbums.map(\n\t\t\t(album, i) => albumIndex === i\n\t\t\t\t? {\n\t\t\t\t\t...album,\n\t\t\t\t\tphotos: photos.map(photos => ({...photos,checked: !album.checked})),\n\t\t\t\t\tchecked: !album.checked,\n\t\t\t\t}\n\t\t\t\t: album\n\t\t);\n\t\tconst newDownloadInfo = {\n\t\t\t...downloadInfo,\n\t\t\tdownloadedContentBlob: null\n\t\t}\n\n\t\tthis.setState({\n\t\t\tuserAlbums: newUserAlbums,\n\t\t\tdownloadInfo: newDownloadInfo\n\t\t});\n\t}\n\n\thandlePhotoChange(e){\n\t\tconst photoDivElem = e.target.parentNode;\n\t\tconst albumIndex = parseInt(photoDivElem.id.match(/(\\d)*-/)[0].slice(0,-1),10);\n\t\tconst photoIndex = parseInt(photoDivElem.id.match(/-(\\d)*/)[0].slice(1),10);\n\t\t\n\t\tconst curState = this.state;\n\t\tconst {photos} = curState.userAlbums[albumIndex];\n\t\tconst checkedPhotos = photos.map(photo => photo.checked);\n\t\tconst newCheckedPhotos = checkedPhotos.map(\n\t\t\t//Logical XOR\n\t\t\t(isPhotoChecked,i) => (i === photoIndex) !== isPhotoChecked\n\t\t);\n\t\t\n\t\tconst newPhotos = this.assignNewCheckedPhotosToArray(photos,newCheckedPhotos);\n\t\t\n\t\tconst newUserAlbums = curState.userAlbums.map(\n\t\t\t(userAlbum,i) => {\n\t\t\t\tlet newUserAlbum;\n\t\t\t\t\n\t\t\t\tif (i === albumIndex) {\n\t\t\t\t\tconst albumChecked = newCheckedPhotos.indexOf(true) !== -1;\n\t\t\t\t\t\n\t\t\t\t\tnewUserAlbum = {\n\t\t\t\t\t\t...userAlbum,\n\t\t\t\t\t\tchecked: albumChecked,\n\t\t\t\t\t\tphotos: newPhotos\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\telse newUserAlbum = userAlbum;\n\n\n\t\t\t\treturn newUserAlbum;\n\t\t\t}\n\t\t);\n\n\t\tconst {downloadInfo} = this.state;\n\t\tconst newDownloadInfo = {\n\t\t\t...downloadInfo,\n\t\t\tdownloadedContentBlob: null\n\t\t}\n\n\t\tthis.setState({\n\t\t\tuserAlbums: newUserAlbums,\n\t\t\tdownloadInfo: newDownloadInfo\n\t\t});\n\n\t}\n\n\tfetchPhoto(photo){\n\t\treturn new Promise((resolve,reject) => {\n\t\t\tfetch(photo.images[0].source)\n\t\t\t.then(response => response.blob())\n\t\t\t.then(blob => resolve({\n\t\t\t\tname: `${photo.id}.jpg`,\n\t\t\t\tblob\n\t\t\t}))\n\t\t\t.catch(reject);\n\t\t});\n\t}\n\n\t//Filter photos checked by user to download\n\tfilterCheckedPhotos(userAlbums){\n\t\treturn userAlbums\n\t\t.filter(album => album.checked)//gets checked albums\n\t\t.map(checkedAlbum => { \n\t\t\t/*\n\t\t\t * maps checked albums in state to objects that contain the \n\t\t\t * checked photos' urls\n\t\t\t */\n\t\t\tconst newCheckedAlbum = {\n\t\t\t\tname: checkedAlbum.name,\n\t\t\t\tindex: checkedAlbum.index,\n\t\t\t\tchecked: checkedAlbum.checked\n\t\t\t};\n\t\t\t\n\t\t\t//fetch the checked photos from 'this.state.userAlbums'\n\t\t\tnewCheckedAlbum.photos = \n\t\t\t\tcheckedAlbum.photos\n\t\t\t\t.map(photo => photo.checked)\n\t\t\t\t.map((checkedPhoto,photoIndex) => {\n\t\t\t\t\tif (checkedPhoto){\n\t\t\t\t\t\tconst photoObject = this.state.userAlbums[checkedAlbum.index].photos[photoIndex];\n\t\t\t\t\t\treturn Object.assign(photoObject,{downloaded: false});\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t})\n\t\t\t\t.filter(photo => photo ? photo.checked : null); //exclude undefineds\n\n\t\t\treturn newCheckedAlbum;\n\t\t});\n\n\t}\n\n\tmarkPhotoAsDownloaded(photoIndex,albumIndex,photosToDownload){\n\t\treturn photosToDownload\n\t\t.map((album,i) => {\n\t\t\treturn albumIndex === i ?\n\t\t\t\tObject.assign(album,{\n\t\t\t\t\tphotos: album.photos.map((photo,j) => \n\t\t\t\t\t\tphotoIndex === j\n\t\t\t\t\t\t? Object.assign(photo,{downloaded: true})\n\t\t\t\t\t\t: photo\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t: album;\n\t\t});\n\t}\n\n\t//downloads images and saves them to user\n\tdownloadImages(){\n\t\tconst {userAlbums} = this.state;\n\t\tconst checkedPhotos = this.filterCheckedPhotos(userAlbums);\n\t\tconst promises = [];\n\t\tconst {downloadInfo} = this.state;\n\n\t\tif (checkedPhotos.length === 0){\n\t\t\tthis.setState({\n\t\t\t\tdownloadInfo: {\n\t\t\t\t\t...downloadInfo,\n\t\t\t\t\tdownloading: false\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn Promise.reject('No photos selected');\n\t\t}\n\n\t\treturn new Promise(resolve => {\n\t\t\tthis.setState({\n\t\t\t\tdownloadInfo: {\n\t\t\t\t\t...downloadInfo,\n\t\t\t\t\tdownloading: true,\n\t\t\t\t\tphotosToDownload: checkedPhotos\n\t\t\t\t}\n\t\t\t},() => {\n\t\t\t\tcheckedPhotos.forEach((album,i) => {\n\t\t\t\t\tpromises.push(\n\t\t\t\t\t\tnew Promise((resolve,reject) => {\n\t\t\t\t\t\t\tPromise.all(album.photos.map((photo,j) => \n\t\t\t\t\t\t\t\tnew Promise((resolve,reject) => {\n\t\t\t\t\t\t\t\t\t// this.fetchPhotoToZipFolder(photo,folder)\n\t\t\t\t\t\t\t\t\tthis.fetchPhoto(photo)\n\t\t\t\t\t\t\t\t\t.then(photoData => {\n\t\t\t\t\t\t\t\t\t\tconst newPhotosToDownload = this.markPhotoAsDownloaded(j,i,this.state.downloadInfo.photosToDownload);\n\t\t\t\t\t\t\t\t\t\tconst newDownloadInfo = Object.assign(this.state.downloadInfo,{photosToDownload: newPhotosToDownload});\n\t\t\t\t\t\t\t\t\t\tthis.setState({downloadInfo: newDownloadInfo});\n\t\t\t\t\t\t\t\t\t\tresolve(photoData);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(reject);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t.then(albumPhotosData => {\n\t\t\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\t\t\tname: album.name,\n\t\t\t\t\t\t\t\t\tphotos: albumPhotosData\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(reject);\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tresolve(Promise.all(promises));\n\n\t\t\t});\t\t\t\n\t\t});\n\t\t\n\t}\n\n\tgetZipFile = (downloadedAlbumsInfo) => {\n\t\tconst zip = new jszip();\n\n\t\tdownloadedAlbumsInfo.forEach(albumInfo => {\n\t\t\tconst folder = zip.folder(albumInfo.name);\n\n\t\t\talbumInfo.photos.forEach(photoData => folder.file(photoData.name, photoData.blob));\n\t\t});\n\t\t\n\t\tconst {downloadInfo} = this.state;\n\t\treturn zip.generateAsync({ type: 'blob' })\n\t\t.then(content => {\n\t\t\tthis.setState({\n\t\t\t\tdownloadInfo: {\n\t\t\t\t\tdownloading: false,\n\t\t\t\t\tdownloadedContentBlob: content,\n\t\t\t\t\tphotosToDownload: this.state.photosToDownload\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn Promise.resolve(content);\n\t\t});\n\t}\n\n\tdownloadImagesAndGetZipFile = () => \n\t\tthis.downloadImages()\n\t\t.then(this.getZipFile)\n\t\t.catch(console.error)\n\t\t\n\n\tdownloadImagesAndSaveZipFile(){\n\t\tthis.downloadImages()\n\t\t.then(this.getZipFile)\n\t\t.then( content => {\n\n\t\t\tthis.setState({\n\t\t\t\tdownloadInfo: {\n\t\t\t\t\tdownloading: false,\n\t\t\t\t\tdownloadedContentBlob: content,\n\t\t\t\t\tphotosToDownload: this.state.photosToDownload\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst aElement = document.createElement('a');\n\t\t\tconst objectURL = URL.createObjectURL(content);\n\n\t\t\taElement.style.display = 'none';\n\t\t\taElement.href = objectURL;\n\t\t\taElement.download = 'photos.zip';\n\n\t\t\tdocument.body.appendChild(aElement);\n\n\t\t\taElement.click();\n\n\t\t})\n\t\t.catch(err => {\n\t\t\tthis.setState({\n\t\t\t\tdownloadInfo: {\n\t\t\t\t\tdownloading: false,\n\t\t\t\t\tphotosToDownload: this.state.photosToDownload\n\t\t\t\t}\n\t\t\t});\n\t\t\tconsole.error(err);\n\t\t});\n\t}\n\n\tgetDownloadedPhotos(){\n\t\tconst {photosToDownload} = this.state.downloadInfo;\n\n\t\treturn photosToDownload\n\t\t.map(album => album.photos)\n\t\t.reduce((a,b) => a.concat(b),[])\n\t\t.filter(photo => photo.downloaded);\n\t}\n\n\tcloseModal = () => this.setState({openModal: false});\n\n\trender(){\n\t\t\n\t\tconst albums = this.state.loaded ? (this.state.userAlbums.map(\n\t\t\t(album,i) => (\n\t\t\t\t\n\t\t\t\t<Album \n\t\t\t\tkey={i}\n\t\t\t\tindex={i}\n\t\t\t\tname={album.name}\n\t\t\t\tphotos={album.photos}\n\t\t\t\tchecked={album.checked}\n\t\t\t\tonAlbumChange={this.handleAlbumChange}\n\t\t\t\tonPhotoChange={this.handlePhotoChange}\n\t\t\t\t/>\n\t\t\t\t\n\t\t\t))\n\t\t) : null;\n\t\t\n\t\tconst \n\t\t\t{downloadInfo,openModal} = this.state,\n\t\t\t{downloadedContentBlob} = downloadInfo;\n\t\t\t\n\n        return (\n\t\t\t<div>\n\t\t\t\t{this.state.loaded ?\n\t\t\t\t<div>\n\t\t\t\t\t{\n\t\t\t\t\t\tdownloadInfo.downloading ?\n\t\t\t\t\t\t\t<DownloadStatus\n\t\t\t\t\t\t\t\tphotosToDownload={downloadInfo.photosToDownload}\n\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t: <React.Fragment>\n\t\t\t\t\t\t\t\t<form id=\"albumList\">{albums}</form>\n\t\t\t\t\t\t\t\t<Button fluid onClick={this.downloadImagesAndSaveZipFile} className='downloadButton'>\n\t\t\t\t\t\t\t\t\tDownload Photos!\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t}\n\n\n\t\t\t\t\t{/* <DriveButton\n\t\t\t\t\t\thidden={downloadInfo.downloading}\n\t\t\t\t\t\tdisabled={this.state.userAlbums && this.filterCheckedPhotos(this.state.userAlbums).length === 0}\n\t\t\t\t\t\tclassName='saveToDriveButton'\n\t\t\t\t\t\tdisplayWhenDownloading={false}\n\t\t\t\t\t\tdisplay='block'\n\t\t\t\t\t\tcontentToUpload={\n\t\t\t\t\t\t\tdownloadedContentBlob ?\n\t\t\t\t\t\t\t\t() => Promise.resolve(downloadedContentBlob)\n\t\t\t\t\t\t\t\t: this.downloadImagesAndGetZipFile\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonFinishUpload={() => this.setState({openModal: true})}\n\t\t\t\t\t/> */}\n\t\t\t\t</div>\n\t\t\t\t: <div>\n\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t<div style={{ textAlign: 'center' }}>Loading...</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\n\t\t\t\t<Modal size='small' open={openModal} onClose={this.closeModal}>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\tPhotos uploaded to Google Drive!\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Actions>\n\t\t\t\t\t\t<Button negative icon='remove' labelPosition='right' content='Close' onClick={this.closeModal} />\n\t\t\t\t\t</Modal.Actions>\n\t\t\t\t</Modal>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nmodule.exports = UserPage;\n","const React = require('react');\nconst Loader = require('react-loader');\n\nfunction getDownloadedPhotos(photosToDownload){\n\treturn photosToDownload\n\t\t.map(album => album.photos)\n\t\t.reduce((a, b) => a.concat(b), [])\n\t\t.filter(photo => photo.downloaded);\n}\n\nmodule.exports = function (props){\n\tconst {photosToDownload} = props;\n\tconst nAllPhotos =\n\t\tphotosToDownload.map(album => album.photos)\n\t\t\t.reduce((a, b) => a.concat(b), [])\n\t\t\t.length;\n\n\tconst downloadedPhotos = getDownloadedPhotos(photosToDownload);\n\treturn (\n\t\t<div className=\"downloadStatus\">\n\t\t\t<Loader />\n\t\t\t<h3>Downloading...(please wait)</h3>\n\t\t\t<h4>{downloadedPhotos.length} / {nAllPhotos} photos</h4>\n\t\t</div>\n\t);\n};\n","const React = require('react');\nconst Photo = require('./Photo');\nconst { Accordion,Icon } = require('semantic-ui-react');\n\nclass Album extends React.Component{\n    constructor(props){\n        super(props);\n\n        this.state = {\n            collapsed: false,\n            active: false\n        };\n\n        this.toggleCollapse = this.toggleCollapse.bind(this);\n        this.toggleActive = this.toggleActive.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n    }\n\n    toggleCollapse(){\n        this.setState({\n            collapsed: !this.state.collapsed\n        });\n    }\n\n    toggleActive(){\n        this.setState({active: !this.state.active});\n    }\n\n    handleChange(e){\n        this.props.onAlbumChange(e,this.props.index);\n    }\n\n    render(){\n\n        const photos = \n            this.props.photos.map(\n                (photo,i) => \n                    (\n                        <Photo\n                            key={i}\n                            id={`photo${this.props.index}-${i}`} \n                            name={photo.name}\n                            images={photo.images}\n                            checked={photo.checked}\n                            handleChange={this.props.onPhotoChange}\n                        />\n                    )\n            ),\n            {active} = this.state;\n\n        return (\n            <div className=\"album\">\n                <Accordion fluid>\n                    <Accordion.Title active={active} index={0} onClick={this.toggleActive}>\n                        <Icon name='dropdown' />\n                        {this.props.name}\n                    </Accordion.Title>\n                    <input\n                        type=\"checkbox\"\n                        checked={this.props.checked}\n                        onChange={this.handleChange}\n                        id={'album' + this.props.index}\n                    />\n                    <Accordion.Content active={active}>\n                        <div className=\"collapse photoContainer\" id={`photoContainer${this.props.index}`}>{photos}</div>\n                    </Accordion.Content>\n\n                   \n                </Accordion>\n            </div>\n        );\n    }\n}\n\nmodule.exports = Album;\n","const React = require('react');\nconst {Button,Modal} = require('semantic-ui-react');\n\nclass Photo extends React.Component{\n\tconstructor(props){\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\topen: false\n\t\t};\n\t\tthis.displayImage = this.displayImage.bind(this);\n\t\tthis.close = this.close.bind(this);\n\t}\n\n\topen(e){\n\t\te.preventDefault();\n\t\tthis.setState({ open: true });\t\t\n\t}\n\n\tclose(e){\n\t\te.preventDefault();\n\t\tthis.setState({ open: false });\t\t\n\t}\n\n\tpreviewImage(e){\n\t\te.preventDefault();\n\t}\n\n\tdisplayImage(){\n\t}\n\n\trender(){\n\t\tconst smallestImage = this.props.images[this.props.images.length - 1],\n\t\t\t{open} = this.state;\n\n\t\tthis.handleClick = this.props.onClick;\n\n\t\treturn (\n\t\t\t<div \n\t\t\t\tid={this.props.id} \n\t\t\t\tclassName=\"photo\" \n\t\t\t\tonChange={this.props.handleChange}\n\t\t\t>\n\t\t\t\t\n\t\t\t\t<label>\n\t\t\t\t\t{this.props.name ? this.props.name : '*Photo without title*'}\n\t\t\t\t</label>\n\t\t\t\t<input type=\"checkbox\" checked={this.props.checked}/>\n\t\t\t\t<Button className='photoButton' onClick={this.open.bind(this)}>Preview</Button>\n \n\t\t\t\t<Modal size='small' open={open} onClose={this.close}>\n\t\t\t\t\t<Modal.Header>\n\t\t\t\t\t\t{this.props.name}\n\t\t\t\t\t</Modal.Header>\n\t\t\t\t\t<Modal.Content style={{textAlign: 'center'}} >\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={smallestImage.source}\n\t\t\t\t\t\t\talt={this.props.name}\n\t\t\t\t\t\t\twidth={smallestImage.width}\n\t\t\t\t\t\t\theight={smallestImage.height}\n\t\t\t\t\t\t\tonClick={this.displayImage}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Modal.Content>\n\t\t\t\t\t<Modal.Actions>\n\t\t\t\t\t\t<Button negative icon='remove' labelPosition='right' content='Close' onClick={this.close}/>\n\t\t\t\t\t</Modal.Actions>\n\t\t\t\t</Modal>\n\t\t\t\t\n\t\t\t</div>\n\t\t);\n\t}\n\n}\n\nmodule.exports = Photo;","const React = require('react');\nconst {Button} = require('semantic-ui-react');\n\n/** \n * \"Save to Drive\" button component\n*/\nclass DriveButton extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\n\t\t/**\n\t\t * API vars\n\t\t */\n\t\tthis.CLIENT_ID = '901501021165-u55km00bs3m29v0lf8g4knccj4oacmik.apps.googleusercontent.com';\n\t\tthis.API_KEY = 'AIzaSyDVpcXLh35yrymzXOzfZdCMsRdUsacUYxA';\n\t\t// Array of API discovery doc URLs for APIs used by the quickstart\n\t\tthis.DISCOVERY_DOCS = ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'];\n\t\t// Authorization scopes required by the API; multiple scopes can be\n\t\t// included, separated by spaces.\n\t\tthis.SCOPES = 'https://www.googleapis.com/auth/drive.file';\n\n\t\tthis.state = {\n\t\t\tsignedIn: false,\n\t\t\tsigninIn: false,\n\t\t\tcontent: undefined\n\t\t};\n\t}\n\t\n\n\tcomponentWillMount(){\n\t\tconst script = document.createElement('script');\n\n\t\tscript.src = 'https://apis.google.com/js/api.js';\n\t\tscript.onload = this.handleClientLoad;\n\n\t\tdocument.body.appendChild(script);\n\t}\n\n\tcreateFile = (fileData) => {\n\n\t\tconsole.log('createFile!!! -> ',fileData);\n\t\tconst boundary = '-------314159265358979323846';\n\t\tconst delimiter = \"\\r\\n--\" + boundary + \"\\r\\n\";\n\t\tconst close_delim = \"\\r\\n--\" + boundary + \"--\";\n\t\tconst title = 'photos.zip';\n\t\tconst {gapi} = this.state;\n\n\t\tvar reader = new FileReader();\n\t\treader.readAsBinaryString(fileData);\n\n\t\treturn new Promise(resolve => {\n\t\t\treader.onload = function (e) {\n\t\t\t\tvar contentType = fileData.type || 'application/octet-stream';\n\t\t\t\tvar metadata = {\n\t\t\t\t\ttitle,\n\t\t\t\t\t'mimeType': contentType\n\t\t\t\t};\n\t\n\t\t\t\tvar base64Data = btoa(reader.result);\n\t\t\t\tvar multipartRequestBody =\n\t\t\t\t\tdelimiter +\n\t\t\t\t\t'Content-Type: application/json\\r\\n\\r\\n' +\n\t\t\t\t\tJSON.stringify(metadata) +\n\t\t\t\t\tdelimiter +\n\t\t\t\t\t'Content-Type: ' + contentType + '\\r\\n' +\n\t\t\t\t\t'Content-Transfer-Encoding: base64\\r\\n' +\n\t\t\t\t\t'\\r\\n' +\n\t\t\t\t\tbase64Data +\n\t\t\t\t\tclose_delim;\n\t\n\t\t\t\tvar request = gapi.client.request({\n\t\t\t\t\t'path': '/upload/drive/v2/files',\n\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t'params': { 'uploadType': 'multipart' },\n\t\t\t\t\t'headers': {\n\t\t\t\t\t\t'Content-Type': 'multipart/mixed; boundary=\"' + boundary + '\"'\n\t\t\t\t\t},\n\t\t\t\t\t'body': multipartRequestBody\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\trequest.execute(resolve);\n\t\t\t}\n\t\t});\n\n\t}\n\n\t/**\n      *  On load, called to load the auth2 library and API client library.\n      */\n    handleClientLoad = () => {\n\t\tthis.setState({ gapi: window.gapi }, function(){ \n\t\t\tthis.state.gapi.load('client:auth2', this.initClient);\n\t\t});\n\t}\n\n\t/**\n       *  Initializes the API client library and sets up sign-in state\n       *  listeners.\n       */\n    initClient = () => {\n\t\tconst self = this,\n\t\t\t{gapi} = this.state;\n\n\t\tgapi.client.init({\n\t\t\tapiKey: self.API_KEY,\n\t\t\tclientId: self.CLIENT_ID,\n\t\t\tdiscoveryDocs: self.DISCOVERY_DOCS,\n\t\t\tscope: self.SCOPES\n\t\t}).then(function () {\n\t\t\t// Listen for sign-in state changes.\n\t\t\tgapi.auth2.getAuthInstance().isSignedIn.listen(this.handleSigninStatusChange);\n\n\t\t\t// Handle the initial sign-in state.\n\t\t\tself.setState({\n\t\t\t\tsignedIn: gapi.auth2.getAuthInstance().isSignedIn.get()\n\t\t\t},function(){\n\t\t\t\tconsole.log('mudou: ',self.state);\n\t\t\t});\n\t\t});\n\t}\n\n\thandleSigninStatusChange = (isSignedIn) => {\n\t\tconst \n\t\t\t{createFile} = this,\n\t\t\t{content} = this.state,\n\t\t\tsetState = this.setState.bind(this);\n\n\t\tif (!content) \n\t\t\treturn;\n\n\t\tsetState({ uploading: true },() => {\n\t\t\tcreateFile(content)\n\t\t\t.then(() => setState({uploading: false}));\n\t\t});\n\t}\n\n\thandleClick = () => {\n\n\t\tconst \n\t\t\t{contentToUpload, onFinishUpload} = this.props,\n\t\t\t{createFile} = this,\n\t\t\t{uploading} = this.state,\n\t\t\tsetState = this.setState.bind(this);\n\n\t\tsetState({downloading: true});\n\t\tcontentToUpload()\n\t\t.then(content => {\n\t\t\tsetState({ downloading: false });\n\t\t\t\n\t\t\tconst authInstance = this.state.gapi.auth2.getAuthInstance();\n\t\t\tif (authInstance.isSignedIn)\n\t\t\t\tsetState({ uploading: true }, () => {\n\t\t\t\t\tcreateFile(content)\n\t\t\t\t\t.then(() => setState(\n\t\t\t\t\t\t{ uploading: false ,content},\n\t\t\t\t\t\tonFinishUpload\n\t\t\t\t\t));\n\t\t\t\t});\n\t\t\telse\n\t\t\t\tauthInstance.signIn();\n\t\t});\n\n\t}\n\n\trender() {\n\t\tconst \n\t\t\t{downloading,uploading} = this.state,\n\t\t\t{displayWhenDownloading,hidden,disabled} = this.props,\n\t\t\tdisplay = hidden ? 'none'\n\t\t\t\t\t: downloading ? \n\t\t\t\t\t\t!displayWhenDownloading ? 'none' : this.props.display \n\t\t\t\t\t: this.props.display;\n\n\t\treturn (\n\t\t\t<Button fluid className={this.props.className} style={{display}} disabled={disabled} loading={uploading} onClick={this.handleClick}>\n\t\t\t\tSave to Google Drive\n\t\t\t</Button>\n\t\t);\n\t}\n}\n\nmodule.exports = DriveButton;","const \n\tReact = require('react'),\n\t{Button, Icon} = require('semantic-ui-react');\n\n\nclass LoginPage extends React.Component{\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {rotate: false};\n\t}\n\t\n\n\thandleClick() {\n\t\tthis.setState({rotate: !this.state.rotate});\n\t}\n\n\trender(){\n\n\t\treturn (\n\t\t\t<div id=\"loginPage\">\n\t\t\t\t<Button color='facebook' onClick={this.props.handleLogin}>\n\t\t\t\t\t<Icon name='facebook' /> Continue with Facebook\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nmodule.exports = LoginPage;","const React = require(\"react\");\nconst UserPage = require(\"./UserPage\");\nconst LoginPage = require(\"./LoginPage\");\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    if (\n      window.location.hostname === \"gcrispino.github.io\" &&\n      window.location.protocol === \"http:\"\n    )\n      window.location.protocol = \"https:\";\n\n    const appId = \"1684103011832056\";\n\n    this.state = {\n      appId,\n      loggedIn: false,\n      sdkLoaded: true\n    };\n\n    this.statusChangeCallback = this.statusChangeCallback.bind(this);\n  }\n\n  componentDidMount() {\n    const self = this;\n\n    (function(d, s, id) {\n      let js,\n        fjs = d.getElementsByTagName(s)[0];\n      if (d.getElementById(id)) return;\n      js = d.createElement(s);\n      js.id = id;\n      js.src = `//connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v6.0&appId=${self.state.appId}`;\n      fjs.parentNode.insertBefore(js, fjs);\n\n      js.addEventListener(\"load\", () => {\n        self.setState({\n          sdkLoaded: true,\n          FB: window.FB\n        });\n      });\n    })(document, \"script\", \"facebook-jssdk\");\n  }\n\n  // This is called with the results from from FB.getLoginStatus().\n  statusChangeCallback(response) {\n    // app know the current login status of the person.\n    console.log(\"statuschange\");\n    if (response.authResponse) {\n      const userId = response.authResponse.userID,\n        accessToken = response.authResponse.accessToken;\n\n      console.log(\"connected!\");\n      console.log(userId, accessToken);\n\n      this.setState({\n        loggedIn: true,\n        userId,\n        accessToken\n      });\n    } else {\n      console.log(\"User cancelled login or did not fully authorize.\");\n    }\n    // The response object is returned with a status field that lets the\n    // Full docs on the response object can be found in the documentation\n    // for FB.getLoginStatus().\n    //    if (response.status === \"connected\") {\n    //      // Logged into your app and Facebook.\n    //      const userId = response.authResponse.userID,\n    //        accessToken = response.authResponse.accessToken;\n    //\n    //      console.log(\"connected!\");\n    //      console.log(userId, accessToken);\n    //\n    //      this.setState({\n    //        loggedIn: true,\n    //        userId,\n    //        accessToken\n    //      });\n    //    } else if (response.status === \"not_authorized\") {\n    //      // The person is logged into Facebook, but not your app.\n    //      document.getElementById(\"status\").innerHTML =\n    //        \"Please log \" + \"into this app.\";\n    //    } else {\n    //      // The person is not logged into Facebook, so we're not sure if\n    //      // they are logged into this app or not.\n    //      document.getElementById(\"status\").innerHTML =\n    //        \"Please log \" + \"into Facebook.\";\n    //    }\n  }\n\n  handleLogin() {\n    window.FB.login(this.statusChangeCallback, { scope: \"user_photos\" });\n  }\n\n  render() {\n    const { userId, accessToken } = this.state;\n    const componentToRender = this.state.sdkLoaded ? (\n      this.state.loggedIn ? (\n        <UserPage userId={userId} accessToken={accessToken} />\n      ) : (\n        <LoginPage handleLogin={this.handleLogin.bind(this)} />\n      )\n    ) : (\n      <div>Loading FB info...</div>\n    );\n\n    return componentToRender;\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (!isLocalhost) {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      } else {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'semantic-ui-css/semantic.min.css';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();"],"sourceRoot":""}